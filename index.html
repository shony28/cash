async function submitOrder() {
    const fromCurrency = document.getElementById('fromCurrency').value;
    const toCurrency = document.getElementById('toCurrency').value;
    const fromAmount = document.getElementById('fromAmount').value;
    const toAmount = document.getElementById('toAmount').value;
    const customerName = document.getElementById('customerName').value;
    const customerPhone = document.getElementById('customerPhone').value;
    const phoneError = document.getElementById('phoneError');

    if (!fromAmount || !toAmount || !customerName || !customerPhone) {
        alert('Будь ласка, заповніть усі поля');
        return;
    }

    if (!validatePhoneNumber(customerPhone)) {
        phoneError.style.display = 'block';
        return;
    }

    if (!settingsData.telegramChatId) {
        alert('Помилка: Telegram Chat ID не налаштовано. Будь ласка, перевірте налаштування.');
        return;
    }

    const { rate, type } = getExchangeRate(fromCurrency, toCurrency);
    let rateDisplay, operationType;

    if (type === 'buy') {
        rateDisplay = rate.toFixed(2);
        operationType = 'купівля';
    } else if (type === 'sell_inverted') {
        const sellRate = ratesData.find(r => getCurrencyCode(r.currency) === toCurrency || r.currency === toCurrency);
        rateDisplay = parseFloat(sellRate.sell).toFixed(2);
        operationType = 'продаж';
    } else {
        rateDisplay = rate.toFixed(2);
        operationType = 'крос-курс';
    }

    const message = `
Замовлення обміну валют:
Отримуєте: ${fromAmount} ${fromCurrency}
Віддаєте: ${toAmount} ${toCurrency}
Курс: ${rateDisplay} (${operationType})
Ім'я: ${customerName}
Телефон: ${customerPhone}
`;

    try {
        const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                chat_id: settingsData.telegramChatId,
                text: message
            })
        });

        if (response.ok) {
            alert('Замовлення успішно відправлено!');
            closeModal();
        } else {
            alert('Помилка при відправленні замовлення. Спробуйте ще раз.');
        }
    } catch (error) {
        console.error('Помилка відправлення до Telegram:', error);
        alert('Помилка при відправленні замовлення. Спробуйте ще раз.');
    }
}
